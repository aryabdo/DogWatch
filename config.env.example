# Configurações padrão do DogWatch
# Editável em: /etc/dogwatch/config.env  (será criado/atualizado pelo install)
#
# Porta SSH primária (alterar conforme necessário)
PRIMARY_SSH_PORT="16309"
# Porta SSH de emergência
EMERGENCY_SSH_PORT="22"
# Usuários permitidos no modo restrito (separados por espaço)
ALLOW_USERS="aasn"
# Portas sempre liberadas durante restauração (exceto 22, ver 000-initial)
RESTORE_EMERGENCY_PORTS="16309"
# Janela permissiva só no snapshot 000-initial
EMERGENCY_WINDOW_ON_000=1
# Tempo máximo da janela permissiva (horas)
EMERGENCY_TTL_HOURS="12"
# Requisito de saída: 1 = ICMP e HTTP, 0 = ICMP ou HTTP
REQUIRE_ICMP_AND_HTTP=1
# Exigir sucesso no teste remoto público (1 = obrigatório)
REQUIRE_PUBLIC_REMOTE=0
# Portas que DEVEM estar sempre abertas (espaço separado)
MANDATORY_OPEN_PORTS="16309"
# Portas extras a monitorar (TCP)
EXTRA_PORTS=""
# Interface(s) preferenciais de rede (vazio = autodetect)
PREFERRED_INTERFACES=""
# Comandos/URLs para testar internet (saída)
PING_TARGETS="1.1.1.1 8.8.8.8"
HTTP_TARGETS="https://www.google.com https://cloudflare.com"
# Flag para não reverter manualmente portas alteradas pelo menu
MANUAL_OVERRIDE_PORTS=0
# Verbozidade do log (INFO|DEBUG)
LOG_LEVEL="INFO"
# Diretórios (não alterar sem necessidade)
DATA_DIR="/opt/dogwatch"
BACKUP_DIR="$DATA_DIR/backups"
LOG_DIR="/var/log/dogwatch"
STATE_DIR="$DATA_DIR/state"
# Intervalos
MONITOR_INTERVAL_SECONDS=300      # 5 min
BACKUP_INTERVAL_SECONDS=1800      # 30 min
MAX_ROTATING_BACKUPS=10
# Serviços que podem afetar conectividade (checagem/ajuste)
FIREWALLS="ufw firewalld nftables iptables"
# Habilitar reparo agressivo (desativar/instalar/desinstalar firewalls que bloqueiam)
AGGRESSIVE_REPAIR=1
# Comandos auxiliares (override se necessário)
CURL_BIN="$(command -v curl || echo /usr/bin/curl)"
NC_BIN="$(command -v nc || echo /usr/bin/nc)"
JQ_BIN="$(command -v jq || echo /usr/bin/jq)"
RSYNC_BIN="$(command -v rsync || echo /usr/bin/rsync)"
SYSCTL_BIN="$(command -v sysctl || echo /usr/sbin/sysctl)"
# Serviço usado para obter o IP público
PUBLIC_IP_SERVICE="https://ifconfig.me"
STOP_SERVICE_ON_SUCCESS=0

# Promover pendências após N ciclos normais
PENDING_STABLE_CYCLES=2
# Exigir conectividade saudável antes de salvar pendência
STRICT_PENDING_CONNECTIVITY=1

# Tentativas/intervalos para aplicar regras de firewall
FIREWALL_APPLY_RETRIES=10
FIREWALL_APPLY_INTERVAL=1
# Forçar uso de apenas um firewall (ex.: ufw)
ENFORCE_SINGLE_FIREWALL="ufw"
# Segurar firewalld para evitar conflitos
HOLD_FIREWALLD=1
# Opções de acesso SSH
SSH_PERMIT_ROOT="no"
SSH_PASSWORD_AUTH="no"
# Reparo somente remoto
REMOTE_ONLY_REPAIR=1
REMOTE_ONLY_REPAIR_CYCLES=3
# Reboot automático após restauração bem-sucedida
RESTORE_AUTO_REBOOT=1

# Restauração automática de IP fixo
AUTO_RESTORE_FIXED_IP=1
FIXED_IP_RESTORE_MIN_INTERVAL=900
NETPLAN_RESTORE_REVERT_SECONDS=180
# Monitorar interface específica (vazio = padrão)
INTERFACE_WATCH=""
